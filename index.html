<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>刷題系統</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #quizContainer { display: none; margin-top: 20px; }
  #answers button { display: block; margin: 5px 0; }
  .correct { background-color: #8fbc8f; color: white; }
  .wrong { background-color: #f08080; color: white; }
</style>
</head>
<body>

<h2>請選擇班級</h2>
<select id="classSelect">
  <option value="">-- 選擇班級 --</option>
  <option value="beginner">初級班</option>
  <option value="intermediate">中級班</option>
  <option value="advanced">高級班</option>
  <option value="study">研經班</option>
</select>
<button id="startBtn">開始作答</button>

<div id="quizContainer">
  <h3 id="question"></h3>
  <div id="answers"></div>
  <button id="nextBtn">下一題</button>
  <p id="score"></p>
</div>

<script>
// 範例題庫
const DATA = {
  beginner: [
    { q: "初級題1", a: ["A1","B1","C1","D1"], correct: 0 },
    { q: "初級題2", a: ["A2","B2","C2","D2"], correct: 1 }
  ],
  intermediate: [
    { q: "中級題1", a: ["A1","B1","C1","D1"], correct: 2 }
  ],
  advanced: [
    { q: "高級題1", a: ["A1","B1","C1","D1"], correct: 3 }
  ],
  study: [
    { q: "研經題1", a: ["A1","B1","C1","D1"], correct: 0 }
  ]
};

let currentClass = "";
let currentQuiz = [];
let currentIndex = 0;
let score = 0;

// 洗牌函數
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

document.getElementById("startBtn").addEventListener("click", () => {
  const select = document.getElementById("classSelect");
  currentClass = select.value;
  if (!currentClass) {
    alert("請先選擇班級！");
    return;
  }
  currentQuiz = shuffle([...DATA[currentClass]]);
  currentIndex = 0;
  score = 0;
  document.getElementById("quizContainer").style.display = "block";
  document.getElementById("score").textContent = "";
  showQuestion();
});

function showQuestion() {
  const qObj = currentQuiz[currentIndex];
  document.getElementById("question").textContent = qObj.q;
  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";
  qObj.a.forEach((ans, i) => {
    const btn = document.createElement("button");
    btn.textContent = ans;
    btn.addEventListener("click", () => {
      // 禁用所有按鈕
      Array.from(answersDiv.children).forEach(b => b.disabled = true);
      // 標記答案
      if (i === qObj.correct) {
        btn.classList.add("correct");
        alert("答對了！");
        score++;
      } else {
        btn.classList.add("wrong");
        // 標記正確答案
        answersDiv.children[qObj.correct].classList.add("correct");
        alert("答錯了！");
      }
    });
    answersDiv.appendChild(btn);
  });
}

document.getElementById("nextBtn").addEventListener("click", () => {
  currentIndex++;
  if (currentIndex >= currentQuiz.length) {
    alert(`已完成本班題目！總答對題數：${score}/${currentQuiz.length}`);
    document.getElementById("quizContainer").style.display = "none";
  } else {
    showQuestion();
  }
});
</script>

</body>
</html>
